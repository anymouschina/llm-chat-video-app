<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>历史记录 | AI Video Demo</title>
    <link rel="stylesheet" href="/home.css" />
  </head>
  <body>
    <header class="topbar">
      <div class="topbar-inner">
        <a class="brand" href="/">AI Video</a>
        <nav class="topnav">
          <a href="/zh/text-to-video/">图文生视频</a>
          <a class="active" href="/zh/history/">历史记录</a>
        </nav>
      </div>
    </header>

    <main class="layout">
      <aside class="sidebar">
        <div class="menu">
          <a class="menu-item" href="/zh/text-to-video/">图文生视频</a>
          <a class="menu-item active" href="/zh/history/">历史记录</a>
        </div>
      </aside>

      <section class="work">
        <div class="panel">
          <h1>生成记录</h1>
          <div class="grid4">
            <div style="grid-column: span 3;">
              <label class="label">按标题过滤（可选）</label>
              <input id="title" class="input" placeholder="输入标题关键字" />
            </div>
            <div style="display:flex;align-items:end;gap:8px;">
              <button class="btn" id="search">查询</button>
              <button class="btn" id="refresh">刷新</button>
            </div>
          </div>
        </div>
        <div class="panel">
          <div id="record-list" class="recent"></div>
        </div>
      </section>

      <!-- Modal: 角色参考截取 -->
      <div id="role-modal" class="modal" style="display:none;position:fixed;inset:0;z-index:9998;">
        <div class="modal-backdrop" id="role-modal-close" style="position:absolute;inset:0;background:rgba(0,0,0,0.4);"></div>
        <div class="modal-content" style="position:relative;z-index:9999;background:#fff;border:1px solid var(--border);border-radius:10px;max-width:900px;width:90vw;margin:8vh auto;padding:16px;">
          <div style="display:flex;align-items:center;gap:8px;margin-bottom:8px;">
            <strong style="flex:1 1 auto;min-width:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">选择角色参考区间</strong>
            <button class="btn" id="role-modal-x">关闭</button>
          </div>
          <div style="margin-bottom:8px;color:#6b7280" id="role-modal-meta"></div>
          <video id="role-video" controls preload="metadata" playsinline style="width:100%;max-height:50vh;background:#111;border-radius:8px;"></video>
          <div style="margin-top:10px">
            <div class="grid4" style="margin-bottom:10px;">
              <div>
                <label class="label">角色名</label>
                <input id="role-name" class="input" placeholder="例如：街头猫侠" />
              </div>
              <div>
                <label class="label">类型</label>
                <input id="role-type" class="input" placeholder="例如：拟人/动物/科幻" />
              </div>
              <div style="grid-column: span 2;">
                <label class="label">描述</label>
                <input id="role-desc" class="input" placeholder="一句话描述该角色…" />
              </div>
            </div>
            <div style="display:flex;gap:8px;align-items:center;margin-bottom:6px;">
              <span class="label">当前</span><span id="role-cur" class="label">0.00s</span>
              <span class="label">/ 时长</span><span id="role-dur" class="label">--</span>
              <div class="spacer"></div>
              <span class="label">起点</span><input id="role-start" class="input" type="number" step="0.01" min="0" value="0" style="width:120px;" />
              <span class="label">终点</span><input id="role-end" class="input" type="number" step="0.01" min="0" value="0" style="width:120px;" />
              <button class="btn" id="role-set-start">设为起点</button>
              <button class="btn" id="role-set-end">设为终点</button>
            </div>
            <div id="timeline" style="position:relative;height:56px;background:#f3f4f6;border:1px solid #e5e7eb;border-radius:6px;overflow:hidden;">
              <div id="frames" style="position:absolute;inset:0;display:flex;gap:0;align-items:stretch;">
                <!-- tiled frame thumbnails will be injected here -->
              </div>
              <div id="sel" style="position:absolute;top:0;height:100%;background:rgba(246,130,31,0.25);border:1px solid #f6821f;border-radius:4px;cursor:move;">
                <div id="handle-l" style="position:absolute;left:-6px;top:0;width:12px;height:100%;cursor:ew-resize;background:rgba(0,0,0,0.1);"></div>
                <div id="handle-r" style="position:absolute;right:-6px;top:0;width:12px;height:100%;cursor:ew-resize;background:rgba(0,0,0,0.1);"></div>
              </div>
            </div>
            <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:10px;">
              <button class="btn primary" id="role-submit">提交</button>
            </div>
          </div>
        </div>
      </div>

      <aside class="results">
        <div class="panel">
          <h2>帮助</h2>
          <p style="color:#6b7280">从远端接口获取生成视频列表；支持按标题过滤。</p>
        </div>
      </aside>
    </main>

    <footer class="footer">© 2025 AI Video Demo</footer>

    <script src="./list.js" type="module"></script>
  </body>
  </html>
